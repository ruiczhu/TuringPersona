# 评估指标文档

## Naturalness

### 1. Perplexity（困惑度）
- **描述**：衡量生成文本的流畅性，值越低表示文本越接近自然语言。
- **取值范围**：`[0, +∞)`，值越小越好。
- **实现方法**：使用 GPT-2 模型计算文本的交叉熵损失，通过 `torch.exp(loss)` 转换得到。

### 2. Coherence（连贯性）
- **描述**：基于句间语义相似度的平均值，衡量文本的逻辑连贯性。
- **取值范围**：`[-1, 1]`，实际为 `[0, 1]`（因使用余弦相似度），值越高越连贯。
- **实现方法**：使用 Sentence-BERT（`all-MiniLM-L6-v2`）编码相邻句子，计算余弦相似度后取均值。

### 3. Diversity（多样性）
- **描述**：基于唯一 N-gram 的比例，衡量文本的词汇丰富度。
- **取值范围**：`[0, 1]`，值越高表示多样性越好。
- **实现方法**：计算文本的 2-gram，统计唯一 N-gram 占总 N-gram 的比例。

### 4. Sentiment Shift（情感偏移）
- **描述**：比较两段文本的情感极性差异，值越大表示情感变化越明显。
- **取值范围**：`[0, 2]`（因 `compound` 范围为 `[-1, 1]`），值越大差异越大。
- **实现方法**：使用 VADER 情感分析器计算 `compound` 得分，取两文本得分的绝对差值。

---

## Personality

### 1. OCEAN 维度平均值
- **描述**：从数据中计算每个对话的 Openness（O）、Conscientiousness（C）、Extroversion（E）、Agreeableness（A）、Neuroticism（N）的平均值。
- **取值范围**：`[0, 1]`，值表示该维度的强度。
- **实现方法**：解析每行数据的 OCEAN 列表后计算均值。

### 2. 预测人格分数
- **描述**：使用 BERT 模型预测文本在 OCEAN 维度上的分数。
- **取值范围**：`[0, 1]`，值表示预测的维度强度。
- **实现方法**：调用本地 `PersonalityDetector` 模型的 `personality_detection` 方法。

### 3. 绝对差值（Absolute Difference）
- **描述**：预测值与实际 OCEAN 平均值的绝对差异，衡量人格预测的准确性。
- **取值范围**：`[0, 1]`，值越小表示预测越准确。
- **实现方法**：直接计算预测值与实际值的绝对差值。

---

## DialogueSimilarity

### 1. TF-IDF 余弦相似度
- **描述**：基于 TF-IDF 向量化的文本表示计算余弦相似度。
- **取值范围**：`[0, 1]`，值越高表示相似度越高。
- **实现方法**：使用 `TfidfVectorizer` 转换文本后调用 `cosine_similarity`。

### 2. Sentence-BERT 相似度
- **描述**：基于 Sentence-BERT 的语义嵌入计算余弦相似度。
- **取值范围**：`[-1, 1]`，实际为 `[0, 1]`，值越高语义越接近。
- **实现方法**：使用 `all-MiniLM-L6-v2` 模型编码文本后计算余弦相似度。

### 3. Jaccard 相似度
- **描述**：基于词集的 Jaccard 相似度，衡量词汇重叠度。
- **取值范围**：`[0, 1]`，值越高表示词汇重叠越多。
- **实现方法**：分词后计算 `1 - jaccard_distance(set1, set2)`。

### 4. 编辑距离（Edit Distance）
- **描述**：两段文本转换为彼此所需的最小单字符编辑次数。
- **取值范围**：`[0, +∞)`，值越小表示文本越接近。
- **实现方法**：调用 NLTK 的 `edit_distance` 直接计算原始字符串。

### 5. BLEU 分数
- **描述**：衡量生成文本与参考文本的 n-gram 匹配度。
- **取值范围**：`[0, 1]`，值越高表示匹配度越好。
- **实现方法**：使用等权重 4-gram（`weights=(0.25, 0.25, 0.25, 0.25)`）计算。

---

## Output
- 单独新建了一个results,放在里面了。